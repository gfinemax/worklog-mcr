- 실시간 모니터링 및 협업 지원
- AI 기반 자동 요약으로 업무 효율성 극대화
- 통계 분석을 통한 인사이트 제공
- **언제 어디서나 접근 가능한 모바일 지원**

### 1.2 주요 메뉴 구조
1. **대시보드** - 당일 현황 및 주요 지표 모니터링
2. **업무일지** - 당일 업무일지 작성 및 관리
3. **업무일지 목록** - 과거 업무일지 조회 및 검색, 업무일지 결제상태, 주요이슈 및 사고 표시
4. **포스트** - 통합 콘텐츠 관리 (메모, 게시글, 답글)
5. **채널 관리** - 방송 채널별 운행표 관리
6. **업무확인 서명** - 4개 파트 서명 관리
7. **통계 및 보고서** - 운행 데이터 분석 및 시각화
8. **사용자 관리** - 계정, 조, 스태프 관리
9. **설정** - 시스템 설정 및 근무 패턴 관리

---

## 2. 사용자 인증 및 권한

### 2.1 로그인 및 세션 로직

**1. 로그인 및 모드 선택 (Login & Mode Selection)**
- **개인 계정 로그인**: 모든 사용자는 본인의 이메일/비밀번호로 로그인합니다.
- **모드 선택 (로그인 직후)**:
  - **🏢 조별 모드 (Shift Mode)**: 현장 근무용. "근무자 확정" 단계로 이동하여 세션을 시작합니다. 조장이 아니더라도 해당 조의 **누구나** 시작할 수 있습니다.
  - **👤 개인 모드 (Personal Mode)**: 개인 업무용. 세션 설정 없이 바로 대시보드로 이동하여 조회, 결재, 댓글 작성 등을 수행합니다.

**2. 근무자 확정 (Session Setup - 조별 모드)**
- **멤버 구성**: 기본적으로 해당 조의 멤버가 표시됩니다.
- **역할 변경**: 드롭다운을 통해 당일 역할(감독/부감독/영상 등)을 자유롭게 변경할 수 있습니다.
- **인원 조정**:
  - **제외**: 휴가/비번 인원은 목록에서 제외.
  - **추가**: 타 조원이나 지원 인력을 검색하여 추가 (역할 지정 가능).
- **근무 시작**: 설정 완료 후 "근무 시작" 버튼으로 대시보드 진입.

**3. 교대 근무 지원 (Handover Support)**
- **교대 로그인**: 공용 PC에서 현재 조가 로그인된 상태에서, **로그아웃 없이** 다음 조가 로그인할 수 있는 기능 제공.
- **대기 조 작업**: 교대 로그인 상태에서 대기 조(다음 조)는 중계현황 페이지 등에 미리 접근하여 작업 가능.
- **중계현황 가져오기**: 대기 조는 이전 조(현재 근무 조)가 작성한 채널별 운행표/중계현황 데이터를 **그대로 복사**해올 수 있음 (반복 입력 방지).

**4. 대시보드 및 업무일지 연동**
- **상태 표시**: 헤더에 현재 모드(조별/개인)와 근무 중인 조 정보 표시.
- **자동 채우기**: 업무일지 작성 시, 확정된 세션 멤버와 역할이 자동으로 반영됨.
- **용어 정의 (Terminology)**:
  - **Group Common (조 공통)**: 특정 멤버가 아닌 조 전체의 이름으로 활동하는 상태를 의미합니다. 시스템 내부적으로는 `"GROUP_COMMON"` 식별자를 사용합니다.

### 2.2 권한 레벨

- 채널별 등록 횟수 실시간 표시
- 실시간 이슈 모니터링

**업무확인 서명 현황**
- 4개 파트 서명 상태
  - 운행 파트
  - 조장 파트
  - MCR 파트
  - Network 파트
- 진행률(%) 표시
- 미서명 알림

**주요 이슈 요약**
- 당일 주요 이슈 목록 (긴급도별)
- 최근 포스트 목록
- AI 요약 표시

**조로그인시 주요이슈 표시**
- AI 요약 표시
- 오늘 근무 주요 송출 내용, 공지 및 주요이슈 및 사고 표시

**중요 포스트 (핀 고정)**
- 관리자 또는 주조감독이 '중요' 표시한 포스트
- 카테고리별 중요 포스트 (최대 5개)
- 포스트 제목, 작성자, 작성일, 카테고리 표시
- 클릭 시 해당 포스트로 이동
- 긴급 사항은 자동으로 대시보드 상단 표시

### 3.2 빠른 액션
- 당일 업무일지 바로가기
- 빠른 메모 작성 (카테고리 선택)
- 긴급 이슈 등록 (자동 중요 표시)
- 중요 포스트 관리 (핀 추가/제거)

---

## 4. 업무일지

### 4.1 근무 체계

**근무일 기준**
- 기준 시간: 당일 07:30 ~ 익일 07:30 (24시간)
- 1일 기준으로 **주간A근무 일지**와 **야간N근무 일지** 각각 작성
- 야간 근무가 이틀에 걸쳐도 활성화된 업무일지 로직으로 정확한 귀속

**근무 패턴 (5조 10교대 순환)**
- **기본 패턴**: ANSYY (5일 주기)
  - **A (Day)**: 주간 근무 (07:30 ~ 18:30)
  - **N (Night)**: 야간 근무 (18:30 ~ 익일 08:00) - 통상 'NS'로 지칭
  - **S (Sleep)**: 야간 근무 종료일 (휴식)
  - **Y (Off)**: 휴무 1
  - **Y (Off)**: 휴무 2

- **10일 순환 및 역할 스왑 (Role Swap)**:
  - 5개 조가 10일 주기로 순환하며, 각 조는 10일 동안 A, N 근무를 각각 2회씩 수행합니다.
  - **1차수 (A1, N1)**: 원래 역할 수행 (감독, 부감독, 영상)
  - **2차수 (A2, N2)**: 감독과 부감독 역할 맞교환 (Swap)
  
  **10일간의 근무 스케줄 (기준일: 2025년 11월 6일 = 1일차)**
  - **1일차**: 주간(A) 1조(A1-정상) / 야간(N) 4조(N2-스왑)
  - **2일차**: 주간(A) 3조(A2-스왑) / 야간(N) 1조(N1-정상)
  - **3일차**: 주간(A) 5조(A1-정상) / 야간(N) 3조(N2-스왑)
  - **4일차**: 주간(A) 2조(A2-스왑) / 야간(N) 5조(N1-정상)
  - **5일차**: 주간(A) 4조(A1-정상) / 야간(N) 2조(N2-스왑)
  - **6일차**: 주간(A) 1조(A2-스왑) / 야간(N) 4조(N1-정상)
  - **7일차**: 주간(A) 3조(A1-정상) / 야간(N) 1조(N2-스왑)
  - **8일차**: 주간(A) 5조(A2-스왑) / 야간(N) 3조(N1-정상)
  - **9일차**: 주간(A) 2조(A1-정상) / 야간(N) 5조(N2-스왑)
  - **10일차**: 주간(A) 4조(A2-스왑) / 야간(N) 2조(N1-정상)

**기준일 설정 (Anchor)**
- **시작일**: 2025년 11월 6일 (1일차 시작)
- **초기 멤버 구성**: 정광훈(감독), 오동섭(부감독), 김단언(영상)

**근무조 운영**
- 5개 조가 10일 순환 패턴으로 운영
- 각 조당 3~4명 구성 (기본 3명 + 상황에 따라 1명 추가)

### 4.2 업무일지 작성

**기본 정보 입력**
- 근무일자
- 근무 구분 (A/N)
- 조 선택
- 근무자 지정
  - 주조감독
  - CMS감독
  - 예비감독
  - 영상감독

**채널별 송출 사항**
- 대상 채널: MBC SPORTS+, MBC Every1, MBC DRAMA, MBC M, MBC ON
- 각 채널 약어 표시 : MBC SPORTS+는 'SP', MBC Every1는 'EV', MBC DRAMA는 'DR', MBC M은 'M', MBC ON은 'ON'
- 각 채널별 운행표 등록 (1~5회)
  - **운행표 수정 기능**:
    - 원형 숫자 버튼(1~5) 클릭 시 타임코드 입력 팝업 표시
    - 각 번호당 1개의 타임코드만 저장 (덮어쓰기 방식)
    - 선택된 번호는 시각적으로 강조 표시 (검은색 배경) 유지
    - 기존 입력값이 있는 경우 팝업에 자동 로드
  - **타임코드 입력**:
    - 기본 형식: `[채널약어] HH:MM:SS:FF부터 정규[N+1]번`
    - 예시: "SP 00:00:00:00부터 정규2번" (MBC SPORTS+, 1번 선택 시)
    - 타임코드 형식: HH:MM:SS:FF (시:분:초:프레임)
    - 유효 범위: 00:00:00:00 ~ 23:59:59:23
    - 범위 초과 시 에러 메시지 표시 및 입력 거부
  - **자동 정렬**:
    - 오른쪽 입력창에 번호 순서대로 오름차순(1→2→3→4→5) 자동 정렬
    - 입력 순서와 무관하게 항상 번호 순서로 표시
    - 오른쪽 입력창은 읽기 전용 (자동 생성)
- 관련 내용 입력 (왼쪽 입력창)
- '글작성' 버튼 → 통합 포스트 작성 및 자동 연결
- 작성 완료 시 AI 요약글 자동 표시

**장비 및 시스템**
- 주요사항 기록
- 추가 이슈 입력
- '메모 추가' 버튼 → 통합 포스트 작성 및 자동 연결

**댓글 알림**
- AI 요약문 옆에 댓글 개수 표시 (💬 3)
- 클릭 시 댓글 목록 표시

### 4.3 상태 관리
- **Draft** (임시저장): 작성 중인 일지
- **Published** (발행): 완료된 일지
- 상태 전환 가능

### 4.4 제약 조건
- 조당 날짜별 1개의 일지만 생성 가능 (Unique Constraint)
- **과거 일지 수정 제한**:
  - 업무일지 본문 및 기본 정보: 읽기 전용 (수정 불가)
  - 연결된 포스트 댓글: 언제든지 작성/수정/삭제 가능
  - 새로운 포스트 추가: 과거 일지에 연결 가능

---

## 5. 업무일지 목록

### 5.1 탭 기반 인터페이스 (Tabbed Interface)
업무일지 목록과 상세 내용을 효율적으로 오갈 수 있도록 **탭(Tab) 방식**의 인터페이스를 제공합니다.

- **목록 탭**: 첫 번째 탭은 항상 '업무일지 목록'으로 고정됩니다.
- **상세 탭**: 목록에서 일지를 클릭하면 새로운 탭이 열리며 상세 내용을 확인할 수 있습니다.
- **탭 제한**: 최대 **5개**의 상세 탭을 동시에 열 수 있습니다. 5개를 초과하면 가장 오랫동안 보지 않은 탭이 자동으로 닫힙니다.
- **상태 유지**: 열려있는 탭 정보는 브라우저에 저장되어, 새로고침 후에도 유지됩니다.
- **URL 공유**: 각 탭은 고유한 URL을 가지며, 특정 일지 탭의 주소를 복사하여 동료에게 공유할 수 있습니다.

### 5.2 검색 및 필터링

**검색 조건**
- 기간 검색 (시작일 ~ 종료일)
- 조 필터
- 근무 구분 (A/N)
- 작성자 검색
- **카테고리 필터** (다중 선택 가능)
- 태그 필터
- 중요도 필터 (일반/중요/긴급)
- 키워드 검색 (제목, 본문)

**정렬 옵션**
- 최신순 / 오래된순
- 조별
- 근무일자별
- 카테고리별

### 5.3 목록 표시

**기본 정보**
- 근무일자
- 조명
- 근무 구분 (A/N)
- 근무자 (주조감독)
- 서명 상태 (진행률 %)
- 포스트 수 / 댓글 수

**빠른 액션**
- 상세보기 (새 탭으로 열기)
- 과거 메모 추가 (해당 일지에 연결)
- PDF 출력

### 5.4 과거 일지 연동
- 특정 Worklog 선택 후 메모 작성 가능
- 작성된 메모는 해당 업무일지에 자동 연결

---

## 6. 포스트 (통합 콘텐츠 관리)

### 6.1 통합 Post 모델

**콘텐츠 유형**
- 채널 메모
- 시스템 메모
- 일반 게시글
- 답글 (Reply)

**필드 구조**
- 제목 (Title)
- 본문 (Content) - Rich Text
- 요약 (Summary) - AI 자동 생성
- 작성자 (Author)
- 연결된 Worklog (Optional)
- Parent (답글용)
- **카테고리 (Category)** - 필수 선택 (10개 중 1개)
- 태그 (Tags) - 선택적, 다중 선택
- **중요 표시 (Is Pinned)** - Boolean, 대시보드 고정용
- **우선순위 (Priority)** - 일반/중요/긴급
- 첨부파일
- 작성일시/수정일시
- 조회수, 좋아요 수

### 6.2 작성 방식

**1. 빠른 메모 (Quick Memo)**
- 업무일지 화면에서 체크박스 클릭
- 팝업 형태로 즉시 작성
- 현재 Worklog에 자동 연결
- 카테고리 필수 선택
- 중요 표시 옵션

**2. 일반 게시글**
- 포스트 목록에서 '새 글 작성'
- Worklog 연결 선택 가능 (Optional)
- 카테고리 필수 선택
- 태그 다중 선택
- 우선순위 설정 (일반/중요/긴급)
- 중요 표시 시 대시보드 고정

**3. 과거 메모**
- 업무일지 목록에서 특정 Worklog 선택
- '메모 추가' 버튼으로 작성
- 선택한 Worklog에 자동 연결
- 카테고리 및 우선순위 선택

**4. 선택적 연결**
- 작성 시 Worklog 선택/해제 가능
- 수정 시 연결 변경 가능
- 중요 표시 변경 가능 (권한자만)

**권한 관리**
- **중요 표시 권한**: 관리자, 주조감독, CMS감독
- **일반 포스트**: 모든 역할
- **긴급 카테고리**: 자동으로 중요 표시

### 6.3 Rich Text Editor
- **에디터**: React Quill 기반
- **지원 기능**
  - 텍스트 서식 (굵게, 기울임, 밑줄)
  - 목록 (순서, 비순서)
  - 링크 삽입
  - 이미지 삽입
  - 코드 블록
  - 인용구

### 6.4 AI 기능

**자동 요약**
- Post 저장 시 백엔드 LLM API 자동 호출
- 본문을 40자 내외로 요약
- `summary` 필드에 자동 저장
- A4 출력용으로 활용

**AI 처리 상태**
- 요약 생성 중
- 요약 완료
- 요약 실패

**서비스 연동**
- `posts/ai_service.py` 모듈
- 게시글 내용 재정리 기능
- AI 처리 상태 추적

### 6.5 계층형 답글 시스템

**댓글 (Comment)**
- 간단한 텍스트 의견
- 빠른 피드백용

**답글 (Reply Post)**
- 독립적인 글로서의 답글
- Post의 `parent` 필드 활용
- 공식 후속 조치 보고서 작성
- Rich Text 지원

### 6.6 분류 및 구조화

**카테고리 시스템**

시스템 기본 카테고리 (관리자가 추가/수정/삭제 가능):

1. **채널 운행** - 채널별 방송 운행 관련 사항
2. **장비 점검** - 정기 및 수시 장비 점검 기록
3. **시스템 이슈** - 시스템 오류 및 이상 현상
4. **긴급 사항** - 즉시 대응이 필요한 긴급 이슈
5. **정기 점검** - 정기적인 유지보수 및 점검
6. **송출 사고** - 방송 송출 중 발생한 사고
7. **기술 지원** - 기술조 협업 및 지원 요청
8. **운영 공지** - 조 내 공지 및 안내사항
9. **협업 요청** - 타 부서/조 협업 관련
10. **기타** - 위 카테고리에 속하지 않는 사항

**카테고리 관리**
- 관리자 권한으로 카테고리 추가/수정/삭제
- 카테고리명, 설명, 색상 지정 가능
- 카테고리 순서 조정
- 사용 중인 카테고리 삭제 시 "기타"로 자동 이동

**카테고리별 기능**
- 카테고리별 필터링 및 검색
- 카테고리별 통계 (사용 빈도)
- 대시보드에서 카테고리별 현황 표시
- 카테고리별 색상 코드로 시각적 구분

**태그 시스템**
- 자유로운 태그 추가 (카테고리와 별개)
- 태그별 필터링
- 태그 자동완성
- 인기 태그 표시
- 태그 통계

**작성자 구분**
- 개인 작성
- 조 단위 작성

### 6.7 커뮤니티 기능

**상호작용**
- 조회수 트래킹
- 추천 (좋아요) 기능
- 북마크

**알림**
- 답글 알림
- 댓글 알림
- 멘션 알림

### 6.8 첨부파일 관리

**첨부 대상**
- WorkLog에 파일 첨부
- ChannelBroadcast에 파일 첨부
- Post에 파일 첨부

**지원 형식**
- 이미지: JPG, PNG, GIF (최대 20MB)
- 문서: PDF, DOCX, XLSX (최대 20MB)

**보안**
- MIME 타입 검증
- 파일 크기 제한
- 업로드 경로 자동 관리
- 악성 파일 차단

---

## 7. 채널 관리

### 7.1 채널 목록

**대상 채널** (5개)
1. MBC SPORTS+
2. MBC Every1
3. MBC DRAMA
4. MBC M
5. MBC ON

### 7.2 운행표 관리

**등록 관리**
- 각 채널별 1~5회 등록 지원
- 등록 횟수 실시간 카운트
- 시간대별 스케줄 표시

**내용 입력**
- 프로그램명
- 방송 시간
- 특이사항
- 관련 내용 입력
- 추가 내용 입력

**연동 기능**
- ChannelBroadcast 모델과 1:1 연동
- 업무일지에서 직접 등록
- 포스트와 자동 연결

### 7.3 실시간 모니터링
- 채널별 등록 현황
- 시간대별 운행 상태
- 이슈 발생 알림

---

## 8. 중계현황 관리 (Broadcast Schedules)

### 8.1 개요
일간 라이브 방송 및 외부 수신 일정을 통합 관리합니다. 수신/송신 네트워크 정보를 체계적으로 기록하여 통계 분석에 활용합니다.

### 8.2 중계 일정 등록

**기본 정보**
- 구분: 라이브 / 수신
- 날짜, 시작시간, 종료시간
- 채널, 스튜디오, 종목/프로그램
- 담당자, 연락처

**수신 설정 (메인/백업)**
- **메인 수신**: 주 신호 경로
- **백업 수신**: 예비 신호 경로
- 각각 망종류 + FS장비/채널 선택

### 8.3 네트워크 프리셋 (자동완성)

**수신(디코더) 프리셋**

| 망종류 | 수신소스 | FS장비/채널 |
|--------|----------|-------------|
| IP망 | LiveU | FA3AO (1-1), FA3BO (1-2), X100-1 (2-1), X100-2 (2-2) |
| IP망 | NIMBRA | KT3 (1-4), KT4 (2-4) |
| IP망 | DR5000 | KT FS3 (Main), KT FS4 (Backup) |
| 광수신 | LG FS | 1~8 |
| 광수신 | NCC FS | 1~6 |
| 위성 | TVRO | 1~8 |

**송신 프리셋**
- TX NCC: 1~7

**리턴 프리셋**
- LG 리턴: 1~4
- IP 리턴: 1~2

**사용자 경험**
- 드롭다운 선택: 프리셋에서 빠르게 선택
- 자유 입력: 프리셋에 없는 값도 직접 입력 가능
- 2단계 연동: 망종류 선택 시 해당 장비만 필터링

### 8.4 통계 활용

**메인/백업별 통계** (핵심)
- 메인 망종류별 사용횟수 및 총 사용시간
- 메인 FS장비별 사용 통계
- 백업 망종류/장비별 통계

**프리셋 관리**
- 저장 위치: `lib/network-config.ts`
- 변경 시: 코드 수정 후 배포 (향후 관리자 페이지 확장 가능)

### 8.5 일단위 중계현황 뷰

**2-Tier 구조**
- **일단위 리스트**: 날짜별로 그룹화된 요약 정보
- **상세 뷰**: 특정 날짜의 전체 중계 일정 (전체화면)

**일단위 리스트 컬럼**
| 컬럼 | 설명 |
|------|------|
| 날짜 | 12/08 (월) |
| 라이브 | 건수 및 완료 상태 (예: 4건 ✅3 🟢1) |
| 수신 | 건수 및 완료 상태 |
| 주요내용 | 대표 프로그램 목록 (최대 3개) |
| 중계/수신 시간 | 라이브/수신 시간 분리 집계 |

**상세 뷰 (전체화면)**
- 사이드바/헤더 없이 화면 전체 활용
- 대시보드 헤더: 요약 카드 + 타임라인 바
- 타임라인 바: 06:00~24:00 시간축에 중계 일정 시각화

### 8.6 중계 상태 관리

**상태 종류**
| 상태 | 표시등 | 설명 |
|------|--------|------|
| 예정 | ⚫ | 아직 시작 전 |
| 대기중 | 🟡 | 시작 30분 전~시작 시간 |
| 진행중 | 🟢 | 현재 방송 중 |
| 완료 | ✅ | 방송 종료 |
| 이슈 | 🔴 | 문제 발생 (수동 설정) |

**종료 시간 기록**
- 완료 버튼 클릭 시 실제 종료 시간 자동 기록
- 라이브/수신 시간 분리 집계
- 통계 페이지 연동: 일간/주간/월간 방송 시간 통계

---

## 9. 업무확인 서명

### 8.1 서명 시스템

**4개 파트 서명**
1. **운행 파트** - 방송 운행 담당자
2. **조장 파트** - 해당 조 조장
3. **MCR 파트** - MCR 책임자
4. **Network 파트** - 네트워크 담당자

### 8.2 서명 프로세스

**서명 순서**
- 순차적 서명 (1 → 2 → 3 → 4)
- 또는 독립적 서명 (순서 무관)

**서명 정보 기록**
- 서명자 ID
- 서명 완료 시각 (Timestamp)
- 서명 상태

### 8.3 상태 모니터링

**진행률 표시**
- 전체 서명 진행률 (%)
- 파트별 서명 상태
  - ✅ 완료
  - ⏳ 대기 중
  - ❌ 미완료

**알림**
- 미서명 파트 알림
- 서명 완료 알림
- 마감 임박 알림

### 8.4 서명 관리
- 서명 취소 (권한자만)
- 서명 이력 조회
- 서명 통계

---

## 9. 통계 및 보고서

### 9.1 운행 통계

**채널별 분석**
- 채널별 등록 횟수 분포
- 시간대별 운행 패턴
- 프로그램별 빈도

**차트**
- 막대 그래프: 채널별 비교
- 선 그래프: 시간대별 추이
- 원 그래프: 비율 표시

### 9.2 이슈 분석

**장비/시스템 이슈**
- 이슈 발생 빈도
- 장비별 고장 통계
- 해결 소요 시간
- 트렌드 분석

**긴급도별 분석**
- 긴급 이슈 비율
- 대응 시간 평균
- 재발 이슈 추적

### 9.3 업무 통계

**일지 작성 현황**
- 월별/주별 작성 건수
- 조별 작성 현황
- 미작성 일지 추적

**담당자별 통계**
- 담당자별 업무량
- 포스트 작성 빈도
- 평균 작업 시간

**카테고리 통계**
- 카테고리별 포스트 수
- 월별/주별 카테고리 추이
- 가장 많이 사용되는 카테고리 TOP 5
- 조별 카테고리 사용 패턴
- 긴급 카테고리 발생 빈도

**태그 통계**
- 인기 태그 TOP 10
- 태그 사용 트렌드
- 태그 연관 분석

### 9.4 기간별 리포트

**주간 리포트**
- 주간 운행 요약
- 주요 이슈 목록
- 다음 주 주의사항

**월간 리포트**
- 월간 운행 통계
- 장비 점검 이력
- 개선 사항

**분기/연간 리포트**
- 장기 트렌드 분석
- 운행 패턴 변화
- 시스템 개선 효과

### 9.5 데이터 시각화

**차트 유형**
- 막대 그래프
- 선 그래프
- 원 그래프
- 히트맵
- 타임라인

**필터링**
- 기간 선택
- 조 선택
- 채널 선택
- 카테고리 선택

**내보내기**
- Excel 다운로드
- PDF 출력
- 이미지 저장

---

## 10. 사용자 관리

### 10.1 계정 관리

**사용자 정보**
- 이름
- 이메일
- 연락처
- 역할 (Role)
- 소속 조
- **사용자 유형 (Type)**: internal (정직원), external (외부 인력), support (지원 인력)
- **조직 (Organization)**: 소속 조직 (지원 인력용)
- **연락처 (Phone)**: 전화번호

**계정 상태**
- 활성화
- 비활성화
- 휴면 계정

**권한 관리**
- 역할별 권한 설정
- 메뉴별 접근 제어
- 기능별 권한 할당

### 10.2 조 관리

**Group 모델**
- 조 생성
- 조 이름 변경
- 조 삭제
- 조원 구성 관리

**조 구성**
- 조원 추가
- 조원 이동
- 조원 제외
- 역할 할당

**10개 조 운영**
- 순환 근무조 관리
- 조별 근무 패턴 설정
- 조별 통계 확인

### 10.3 외부 스태프 및 지원 인력 관리

**통합 Users 모델**
- 모든 스태프(정직원, 외부, 지원)를 `Users` 테이블에서 통합 관리
- `type` 필드로 구분
- `organization` 필드로 소속 관리

**관리 기능**
- 스태프 추가/수정/삭제
- 유형별 필터링 및 검색
- 권한 관리 통합

---

## 11. 설정

### 11.1 근무조 및 패턴 관리 (Flexible Shift System)

**핵심 철학: 버전 관리 (Versioning)**
- 근무 패턴이나 역할 구성이 변경되더라도, **과거의 데이터는 변경 당시의 규칙**을 따라야 합니다.
- 따라서 모든 설정은 `유효 기간(Effective Date)`을 가집니다.

### 11.1 근무조 및 패턴 관리 (Flexible Shift System)

**핵심 철학: 기본 역할 + 변동 규칙 (Base Role + Variation Rule)**
- **근무자 관리**: 사용자는 `group_members` 테이블에서 **'기본 역할(Default Role)'**을 부여받습니다. (예: 정광훈=감독, 오동섭=부감독)
- **근무 패턴**: `shift_pattern_configs` 테이블에서 날짜별/근무별 **'스왑 규칙(Swap Rule)'**을 정의합니다.
- **최종 역할 결정**: 로그인 시, `기본 역할`에 `스왑 규칙`을 적용하여 `현재 역할`을 계산합니다.

**데이터 모델링 상세**

1.  **근무자 배정 (Group Members)**
    - 테이블: `group_members`
    - 필드: `user_id`, `group_id`, `default_role`
    - 예시:
      - 정광훈 (1조, **감독**)
      - 오동섭 (1조, **부감독**)
      - 김단언 (1조, **영상**)

2.  **근무 패턴 설정 (Shift Pattern Configs)**
    - 테이블: `shift_pattern_configs`
    - 필드: `pattern_json` (10일치 데이터)
    - 구조 예시:
      ```json
      [
        {
          "day": 1,
          "A": { "team": "1조", "is_swap": false }, // 1차수: 원래 역할
          "N": { "team": "4조", "is_swap": true }  // 2차수: 스왑 적용
        },
        ...
      ]
      ```

3.  **역할 변환 로직 (Role Resolution Logic)**
    - **Normal (is_swap = false)**:
      - 감독 -> 감독
      - 부감독 -> 부감독
    - **Swap (is_swap = true)**:
      - 감독 -> 부감독
      - 부감독 -> 감독
      - 영상 -> 영상 (변동 없음)

4.  **예외 처리 (Exception Handling - Substitutes)**
    - **계획 vs 현실 (Plan vs Reality)**:
      - `shift_pattern_configs`는 **'계획(Plan)'**을 정의합니다.
      - 실제 근무 시 발생하는 변동(지원 근무, 교체 등)은 **'현실(Reality)'**로서 `work_sessions` 생성 시점에 반영됩니다.
    - **지원 근무 처리**:
      - 로그인 후 '근무자 확정' 단계에서 기본 배정된 인원을 제외하거나, 외부 인원을 추가할 수 있습니다.
      - 이때 `work_session_members` 테이블에 `is_substitute=true`로 기록되어, 원래 계획과 실제 근무를 구분하여 관리합니다.
      - **결론**: 현재의 근무자 관리 시스템은 이러한 유연성을 이미 지원하고 있으므로 문제가 없습니다.

### 11.2 업무일지 포맷 관리

**포맷 설정**
- A4 출력용 레이아웃
- 섹션 구성 변경
- 필드 표시/숨김
- 폰트 및 스타일

**관리 기능**
- 포맷 템플릿 생성
- 포맷 수정
- 포맷 미리보기
- 반영 시점 설정

**적용**
- 즉시 반영 또는 예약 반영
- 일지 출력 시 자동 적용

### 11.3 카테고리 관리

**카테고리 설정**
- 카테고리 추가
  - 카테고리명 (필수)
  - 설명 (선택)
  - 색상 코드 지정 (UI 구분용)
  - 아이콘 선택 (선택)
- 카테고리 수정
  - 이름, 설명, 색상 변경
  - 순서 조정 (드래그 앤 드롭)
- 카테고리 삭제
  - 사용 중인 경우 경고 메시지
  - 삭제 시 해당 포스트를 "기타" 카테고리로 자동 이동
  - 삭제 이력 관리

**기본 카테고리**
- 시스템이 제공하는 10개 기본 카테고리
- 기본 카테고리도 수정/삭제 가능
- 최소 1개 카테고리는 유지 필요

**카테고리 통계**
- 카테고리별 사용 빈도
- 인기 카테고리 분석
- 미사용 카테고리 표시

### 11.4 시스템 설정

**일반 설정**
- 시스템 이름
- 로고
- 테마 (다크 모드)
- 언어

**알림 설정**
- 이메일 알림
- 앱 푸시 알림
- 알림 시간대

**보안 설정**
- 세션 타임아웃
- 비밀번호 정책
- 2단계 인증 (Optional)

### 11.5 데이터 관리

**백업**
- 자동 백업 설정
- 백업 주기
- 백업 저장 경로

**복원**
- 백업 파일 목록
- 특정 시점 복원
- 선택적 복원

**데이터 정리**
- 오래된 데이터 아카이브
- 로그 파일 정리
- 임시 파일 삭제

---

## 12. 데이터베이스 설계 (Supabase/PostgreSQL)

### 12.1 ERD 개요

시스템의 핵심 엔티티 관계:
- Users ↔ Groups (다대다)

### 14.1 시나리오 1: 주조감독의 A근무 업무일지 작성

**상황**: 3조 주조감독 김철수가 A근무(07:30~19:00) 업무일지를 작성

**단계**:
1. **로그인 및 세션 설정**
   - 개인 계정(이메일/비번)으로 로그인.
   - 시스템이 "3조" 소속임을 확인하고 세션 설정 화면 표시.
   - 3조 멤버(김철수, 이영희, 박민수, 최기술) 목록 확인.
   - 오늘 휴가인 "최기술" 제외, 지원 나온 "홍길동" 검색하여 추가.
   - "근무 시작하기" 클릭.

2. **대시보드 확인**
   - 당일(2025-11-20) 근무 정보 확인
   - 상단에 "3조 근무 중" 표시 및 현재 멤버(김철수, 이영희, 박민수, 홍길동) 확인.
   - 4개 파트 서명 현황 확인 (모두 대기 중)
   - 중요 포스트 2개 확인

3. **업무일지 작성**
   - "업무일지" 메뉴 클릭
   - 당일 3조 A근무 일지 자동 생성 (이미 존재하면 불러오기)
   - 채널별 운행표 등록:
     * MBC SPORTS+: 3회 등록, "프로야구 중계" 입력
     * MBC Every1: 2회 등록, "예능 프로그램" 입력
   - 장비 점검 사항: "메인 서버 정상 가동" 입력

4. **포스트 작성 (채널 메모)**
   - MBC SPORTS+ 항목에서 "글작성" 버튼 클릭
   - 팝업 표시, 작성자 선택: "김철수" 선택
   - 제목: "프로야구 중계 송출 완료"
   - 카테고리: "채널 운행" 선택
   - 본문: "오후 2시~6시 프로야구 중계 정상 송출..."
   - 저장 → AI 자동 요약 생성: "프로야구 중계 정상 송출"
   - 업무일지에 요약 표시

5. **긴급 이슈 발생**
   - 15:30, 네트워크 일시 불안정 발생
   - "빠른 메모" 클릭
   - 작성자: "김철수" 선택
   - 카테고리: "긴급 사항" 선택 (자동으로 중요 표시)
   - 제목: "네트워크 일시 불안정"
   - 본문: "15:30경 약 2분간 네트워크 불안정, 자동 복구됨"
   - 저장 → 대시보드에 자동 표시

6. **업무일지 발행**
   - 모든 내용 작성 완료
   - "발행" 버튼 클릭 → 상태: Draft → Published

7. **서명 요청**
   - "업무확인 서명" 메뉴 이동
   - 2025-11-20, 3조 업무일지 서명 요청
   - 운행 파트에 알림 발송

8. **로그아웃**
   - 근무 종료 시 자동 로그아웃

### 14.2 시나리오 2: CMS감독의 모바일에서 댓글 작성

**상황**: 2조 CMS감독 이영희가 집에서 모바일로 과거 일지 댓글 작성
