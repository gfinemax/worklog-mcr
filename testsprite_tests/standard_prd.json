{
  "meta": {
    "project": "ShiftWork Management System",
    "date": "2025-12-05",
    "prepared_by": "Software Development Manager"
  },
  "product_overview": "A comprehensive shift work management system designed to handle user authentication, worklog management, shift scheduling, and task posting with a responsive UI for desktop and mobile.",
  "core_goals": [
    "Ensure secure and seamless user authentication with session persistence and role-based UI access.",
    "Maintain data integrity and real-time synchronization for worklog management including signature handling and autosave features.",
    "Implement accurate shift scheduling algorithms for complex multi-shift rotation patterns with swap capabilities.",
    "Deliver stable and responsive UI/UX including dashboard widgets, dialogs, and mobile-friendly layouts.",
    "Optimize state management to avoid data leaks and unnecessary re-renders ensuring smooth performance."
  ],
  "key_features": [
    "User Authentication with session management, role-based UI access, and separate shift worker login handling.",
    "Worklog management enabling creation, editing, viewing, real-time data sync, auto-save, and robust signature parsing with fallback handling.",
    "Shift management with accurate rotation logic for 3-shift and 4-shift or other complex patterns, including shift swap operations.",
    "Main dashboard displaying statistics, recent posts, and signature progress with responsive and stable layout.",
    "Issue and notice posting capability with editor components for communication.",
    "State management optimized via Zustand to prevent stale or sensitive data retention and minimize unnecessary renders."
  ],
  "user_flow_summary": [
    "User logs in via the login page, session persists across refreshes; depending on role, dashboard and UI access adjust accordingly.",
    "User creates or edits worklogs; auto-save protects against data loss; modifications and signatures update in real-time across users.",
    "Shift pattern is managed via wizard and algorithmically calculated shifts, including handling swaps with reflected updates in dashboard and worklogs.",
    "User views dashboard with up-to-date stats, signature progress, and recent posts; dialogs for issues or worker registration can overlay without UI conflicts.",
    "User logs out ensuring all sensitive states are cleared from memory to prevent leakage or stale data retention."
  ],
  "validation_criteria": [
    "Session persistence and separation of concurrent shift worker login sessions verified without conflict.",
    "Worklog real-time synchronization tested with multiple users editing or signing simultaneously.",
    "Autosave functionality confirmed to prevent data loss on network failure or tab closure.",
    "Signature data parsing handles null, system auto-close indicators, and corrupted JSON gracefully without application crash.",
    "Shift rotation calculations checked for edge cases like leap years and month boundaries, and swap logic updates reflected correctly in UI and data.",
    "Dashboard layout remains intact under no data and overflow conditions; dialog overlay and focus management perform correctly.",
    "Mobile responsiveness validated for table views and layout stability on various device sizes.",
    "State stores wipe sensitive data on logout and minimize unnecessary component re-renders via selective selectors."
  ],
  "code_summary": {
    "tech_stack": [
      "TypeScript",
      "Next.js",
      "Supabase",
      "TailwindCSS",
      "Zustand",
      "Radix UI"
    ],
    "features": [
      {
        "name": "Authentication",
        "description": "User login, session management, and handover login logic.",
        "files": [
          "store/auth.ts",
          "components/auth/auth-provider.tsx",
          "app/(dashboard)/login/page.tsx",
          "components/auth/login-form.tsx",
          "components/auth/session-setup-step.tsx"
        ]
      },
      {
        "name": "Worklog Management",
        "description": "Creating, editing, viewing worklogs, and signature management.",
        "files": [
          "store/worklog.ts",
          "components/worklog/worklog-detail.tsx",
          "app/worklog/page.tsx",
          "app/worklog/[id]/page.tsx",
          "components/worklog/channel-row.tsx"
        ]
      },
      {
        "name": "Shift Management",
        "description": "Shift rotation logic, shift wizard for roster management.",
        "files": [
          "lib/shift-rotation.ts",
          "store/shift-wizard-store.ts",
          "app/(dashboard)/settings/shift-pattern/page.tsx"
        ]
      },
      {
        "name": "Dashboard",
        "description": "Main dashboard with stats, recent posts, and signature progress.",
        "files": [
          "app/(dashboard)/page.tsx"
        ]
      },
      {
        "name": "Posts & Issues",
        "description": "Posting issues and notices.",
        "files": [
          "store/posts.ts",
          "components/post-editor.tsx"
        ]
      }
    ]
  }
}
